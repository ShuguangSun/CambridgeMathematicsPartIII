
\chapter{Conjugate Functions}
\label{cha:conjugate-functions}

\section{The Legendre-Fenchel Transform}
\label{sec:legendre-fench-trans}

\begin{defn}
  \label{defn:conjugate_functions:1}
  For $f: \R^{n} \rightarrow \bar \R$, define
  \begin{equation}
    \label{eq:46}
    \con f(x) = \sup_{g \leq f, \text{$g$ convex}} g(x)
  \end{equation} is the convex hull of $f$.
\end{defn}

\begin{proposition}
  $\con f$ is the greatest convex function majorized by $f$.
\end{proposition}

\begin{defn}
  \label{defn:conjugate_functions:2}
  For $f: \R^{n} \rightarrow \bar \R$, the (lower) closure of $f$ is
  defined as
  \begin{equation}
    \label{eq:47}
    \cl f(x) = \liminf_{y \rightarrow x} f(y)
  \end{equation}
\end{defn}

\begin{proposition}
  For $f: \R^{n} \rightarrow \bar \R$,
  \begin{equation}
    \label{eq:48}
    \epi (\cl f) = \cl (\epi f)
  \end{equation}
  In particular, if $f$ is convex, then $\cl f$ is convex.
\end{proposition}

\begin{proof}
  Exercise.
\end{proof}

\begin{proposition}
  If $f: \R^{n} \rightarrow \bar \R$, then
  \begin{equation}
    \label{eq:49}
    (\cl f)(x) = \sup_{g \leq f, \text{$g$ lsc}} g(x)
  \end{equation}
\end{proposition}

\begin{proof}
  \todo{Fill in}
\end{proof}

\begin{thm}
  \label{defn:conjugate_functions:3}
  Let $C \subseteq \R^{n}$ be closed and convex.  Then
  \begin{equation}
    \label{eq:50}
    C = \bigcap_{(b, \beta) s.t. c \subseteq H_{b, \beta}} H_{b, \beta}
  \end{equation} where
  \begin{equation}
    \label{eq:51}
    H_{b, \beta} = \{ x \in \R^{n} | \langle x, b \rangle - \beta
    \leq 0 \}
  \end{equation}
\end{thm}

\begin{proof}
  \todo{}
\end{proof}

\begin{thm}
  \label{defn:conjugate_functions:4}
  Let $f: \R^{n} \rightarrow \bar \R$ be proper, lsc, and convex.
  Then
  \begin{equation}
    \label{eq:52}
    f(x) = \sup_{g \leq f, \text{$g$ affine}} g(x)
  \end{equation}
\end{thm}

\begin{proof}
  \todo{This is quite an involved proof.}
\end{proof}

\begin{defn}
  \label{defn:conjugate_functions:5}
  For $f: \R^{n} \rightarrow \bar \R$, let $f^{\star}: \R^{n}
  \rightarrow \bar \R$ be defined by
  \begin{equation}
    \label{eq:53}
    f^{\star}(v) = \sup_{x \in \R^{n}} \{ \langle v, x \rangle - f(x) \}
  \end{equation}
  as the \textbf{conjugate} to $f$. The mapping $f \mapsto f^{\star}$
  is the \textbf{Legendre-Fenchel Transform}
\end{defn}

\begin{remark}
  For $v \in \R^{n}$, 
  \begin{align}
    \label{eq:126}
    f^{\star}(v) &= \sup \{ x \in \R^{n} \{ \langle v, x \rangle - f(x)
    \} \\
    \Rightarrow f^{\star}(v) &\geq \langle v, x \rangle - f(x)
    \forall x \in \R^{n} \iff f(x) \geq \langle v, x \rangle -
    f^{\star}(x) \forall x \in \R^n.
  \end{align}

  Thus $f^{\star}$ is the largest affine function with gradient $v$
  majorized by $f$.
\end{remark}

\begin{thm}
  \label{defn:conjugate_functions:6}
  Assume $f: \R^{n} \rightarrow \bar \R$.  Then
  \begin{enumerate}
  \item $f^{\star} = (\con f)^{\star} = (\cl f)^{\star} = (\cl \con
    f)^{\star}$ and $f \geq f^{\star \star} = (f^{\star})^{\star}$,
    the \textbf{biconjugate} of $f$.
  \item If $\con f$ is proper, then $f^{\star}, f^{\star \star}$ as
    proper, lower semicontinuous, convex and $f^{\star \star}= \cl
    \con f$.
  \item If $f: \R^{n} \rightarrow \bar \R$ is proper, lower
    semicontinuous, and proper, then
    \begin{equation}
      \label{eq:54}
      f^{\star \star} = f
    \end{equation}
  \end{enumerate}
\end{thm}

\begin{proof}
  We have
  \begin{equation}
    \label{eq:55}
    (v, \beta) \in \epi f^{\star} \iff \beta \geq \langle v, x
    \rangle - f(x) \forall x \in \R^{n} \iff f(x) \geq \langle v, x
    \rangle - \beta \forall x \in \R^{n}
  \end{equation}

  We claim that for an affine function $h$, we have $h \leq f \iff h
  \leq con f \iff h \leq \cl f \iff h \leq \cl \con f$. This is shown
  as $\con f$ is the largest convex function less than or equal to
  $f$, and $h$ is convex. Same for $\cl, \cl \con$, etc.

  Thus in \eqref{eq:55} we can replace $f$ by $\con f$, $\cl f$, $\cl
  \con f$, which gives our required result.

  We also have
  \begin{align}
    \label{eq:56}
    f^{\star \star}(y) & = \sup_{v \in \R^{n}} \{ \langle v, y \rangle - \sup_{x \in \R^{n}}  \{ \langle v, x \rangle - f(x) \} \} \\
                       & \leq \sup_{v \in \R^{n}} \{ \langle v, y \rangle - \langle v, y  \rangle + f(y) \} \\
                       & = f(y)
 \end{align}
                     
  
  For the second part, we have $\con f$ is proper, and claim that $\cl
  \con f$ is proper, lower semicontinuous, and convex.

  Lower semicontinuity is a give.  Convexity is given by the previous
  proposition that $f$ is convex implies $\cl f$ is convex.
  Properness is to be shown in an exercise.

  Applying the previous theorem,
  \begin{align}
    \label{eq:57}
    \cl \con f(x) &= \sup_{g \in \cl \con f, \text{$g$ affine}} g(x) \\
    &= \sup_{(v, \beta) \in \epi f^{\star}} \{ \langle v, x \rangle - \beta \}
  \\
    &= \sup_{(v, \beta) \in \epi f^{\star}} \{ \langle v, x \rangle -
    f^{\star}(v) \} \\
    &= \sup_{v \in \dom f^{\star}} \{ \langle v, x \rangle -
    f^{\star}(v) \} \\
    &= \sup_{v \in \R^{n}} \{ \langle v, x \rangle - f^{\star}(v) \} -
    f^{\star \star}(x)
  \end{align}
  with $g(x) \leq \langle v, x \rangle - \beta$, $(v, \beta) \in \epi (\cl \con f)^{\star} \iff (v, \beta) \in \epi f^{\star}$.

  To show $f^{\star}$ is proper, lower semicontinous, and convex, we
  have $\epi f^{\star}$ is the intersecton of closed convex sets, and
  therefore closed and convex, and hence $f^{\star}$ is lower
  semicontinuous and convex.

  To show properness, we have $\con f$ is proper implies there exists
  $x \in \R^{n}$ with $\con f(x) < \infty$. Then $f^{\star}(v) =
  \sup_{x \in \R^{n}} \{ \langle v, x \rangle - f(x) \}$, which is
  greater than $-\infty$.

  If $f^{\star} \equiv +\infty$, then $\cl \con f = f^{\star \star} =
  \sup_{v} \langle v, x - f^{\star}(x) \equiv -\infty$, and so $\cl
  \con f$ is proper, which implies $f^{\star}$ is proper, lower
  semicontinuous, and convex. Applying to $f^{\star}$ - we need $\con
  f^{\star}$ proper (which is proper by previous result),, and thus
  $f^{\star \star}$ is proper, lower semicontinuous, and convex.

  For part 3, apply 2 - $f$ is convex, which implies $\con f = f$ and
  $\con f$ is proper (as $f$ is proper), and $f$ is lsc and convex,
  and thus $f^{\star \star} = \cl \con f = f$.
\end{proof}


\section{Duality Correspondences}
\label{sec:dual-corr}

\begin{thm}
  \label{defn:conjugate_functions:7}
  Let $f: \R^{n} \rightarrow \bar \R$ be proper, lower semicontinuous,
  and convex. Then:
  \begin{enumerate}
  \item $\partial f^{\star} = (\partial f)^{-1}$
  \item $v \in \partial f(x) \iff f(x) + f^{\star}(v) = \langle v, x
    \rangle \iff x \in \partial (f^{\star})(v)$.
  \item
    \begin{align}
      \label{eq:58}
      \partial f(x) &= \argmax_{v'} \{ \langle v', x \rangle - f^{\star}(v') \}  \\
      \partial f^{\star}(x) &= \argmax_{x'} \{ \langle v, x' \rangle - f(x') \}  \\
    \end{align}

  \end{enumerate}
\end{thm}

\begin{proof}
  \begin{enumerate}
  \item This is obvious from (2)
  \item
    \begin{align}
      \label{eq:59}
      f(x) + f^{\star}(v) &= \langle v, x \rangle \\
      &\iff \{ f^{\star}(v) = \langle v, x \rangle - f(x)  \\
      &\iff x \in \argmax \{ \langle v, x' \rangle - f(x') \}  \\
      &...
    \end{align}
  \end{enumerate}
  \todo{Finish off proof}
\end{proof}

\begin{proposition}
  Let $f: \R^{n} \rightarrow \bar \R$ be proper, lower semicontinuous,
  and convex.  Then
  \begin{align}
    (f(\cdot) - \langle a, \cdot \rangle)^{\star} = f^{\star(\cdot +
      a)} \\
    (f(\cdot + b))^{\star} = f^{\star}(\cdot) - \langle \cdot, b
    \rangle \\
    (f(\cdot) + c)^{\star} = f^{\star}(\cdot) - c \\
    (\lambda f(\cdot))^{\star} = \lambda
    f^{\star}(\frac{\cdot}{\lambda}), \lambda > 0 \\
    (\lambda f(\frac{\cdot}{\lambda}))^{\star} = \lambda f^{\star}(\cdot)
  \end{align}
\end{proposition}

\begin{proof}
  Exercise
\end{proof}

\begin{proposition}
  $f_{i}: \R^{n} \rightarrow \bar \R$, $i: 1, \dots, m$ proper,
  $f(x_{1}, \dots, x_{m}) = \sum_{i} f_{i}(x_{i})$.  Then
  $f^{\star}(v_{1}, \dots, v_{m}) = \sum_{i} f^{\star}(v_{i})$
\end{proposition}

\begin{defn}
  \label{defn:conjugate_functions:8}
  For any set $S \subseteq \R^{n}$, define the support function
  \begin{align}
    \label{eq:63}
    G_{S}(v) = \sup_{x \in S} \langle v, x \rangle = (\delta_{S})^{\star}(v)
  \end{align}
\end{defn}

\begin{defn}
  \label{defn:conjugate_functions:9}
  A function $h: \R^{n} \rightarrow \bar \R$ is \textbf{positively
    homogenous} if $0 \in \dom h$ and $h(\lambda x) = \lambda h(x)$
  for all $\lambda > 0, x \in \R^{n}$.
\end{defn}

\begin{proposition}
  The set of positive homogenous proper lowersemicontinuous convex
  functions and the set of closed convex nonempty sets are in
  one-to-one correspondence through the Legendre-Fenchel transform.
  \begin{equation}
    \label{eq:64}
    \delta_{C} \leftrightarrow G_{C}    
  \end{equation}
  and
  \begin{equation}
    \label{eq:65}
    x \in \partial G_{C}(v) \iff x \in C
  \end{equation}
  and
  \begin{equation}
    \label{eq:66}
    G_{C}(v) = \langle v, x \rangle \iff v \in N_{C}(x) = \partial \delta_{C}(x)
  \end{equation}

  The set of closed convex cones is in one-to-one correspondence with
  itself:
  \begin{align}
    \label{eq:67}
    \delta_{K} &\leftrightarrow \delta_{K^{\star}} \\
    K^{\star} &= \{ v \in \R^{n} | \IP{v, x} \leq 0 \forall
    x \in K \}
  \end{align}
  and
  \begin{align}
    \label{eq:128}
    x \in N_{K^{\star}}(v) &\iff x \in K, v \in K^{\star}, \\
    \IP{x, v} = 0 &\iff v \in N_{K}(x)
  \end{align}
\end{proposition}

\chapter{Duality in Optimization}
\label{cha:duality-optimization}

\begin{defn}
  \label{defn:conjugate_functions:10}
  For $f: \R^{n} \times \R^{m} \rightarrow \bar \R$ proper,
  lowersemicontinuous, convex, we define the primal and dual problems
  \begin{align}
    \label{eq:68}
    \inf_{x \in \R^{n}} \phi(x), \phi(x) = f(x, 0) \\
    \sup_{y \in \R^{m}} \psi(y), \psi(y) = f^{\star}(0, y)
  \end{align}
  and the \textbf{$\inf$-projections}
  \begin{align}
    \label{eq:69}
    p(u) = \inf_{x \in \R^{n}} f(x, u) \\
    q(v) = \inf_{y \in \R^{m}} f^{\star}(v, y)
  \end{align}

  $f$ is the peturbation function for $\phi$, $p$ is the associated
  projection function.

  Consider the problem
  \begin{equation}
    \label{eq:70}
    \inf_{x} \frac{1}{2} \| x - z \|^{2} + \delta_{\geq 0} (Ax - b) =
    \inf \phi(x)
  \end{equation}
  Consider the perturbed problem
  \begin{equation}
    \label{eq:71}
    f(x, u) = \frac{1}{2} \| x - z \|^{2} + \delta_{\geq 0} (Ax - b + u)
  \end{equation}
\end{defn}

\begin{proposition}
  Assume $f$ statisfying the assumptions in Definition
  \ref{defn:conjugate_functions:10}.  Then
  \begin{enumerate}
  \item $\phi, -psi$ are convex and lower semicontinuous
  \item $p, q$ are convex
  \item $p(0) = \inf_{x} \phi(x)$
  \item $p^{\star \star}(0) = \sup_{y} \psi(y)$
  \item $\inf_{x} \phi(x) < \infty \iff 0 \in \dom p$
  \item $\sup \psi(y) > -\infty \iff 0 \in \dom q$
  \end{enumerate}
\end{proposition}

\begin{proof}
  \begin{enumerate}
  \item $\phi$ is clearly convex.  For $\psi$, $f^{\star}$ is
    lowersemicontinuous and convex, which implies $-\psi$ is
    lowersemicontinuous and convex.
  \item Look at the strict epigraph of $p$:
    \begin{align}
      \label{eq:73}
      E = \{ (u, \alpha) \in \R^{m} \times \R | p(u) < \alpha \} \\
      &= \{ (u, \alpha) \in \R^{m} \times \R | \exists x : f(x, u) <
      \alpha \} \\
      &= A \{ (u, \alpha, x) \in \R^{m} \times \R \times \R^{n} | f(x,
      u) \leq \alpha \} \\
      &= A(u, \alpha, x) \mapsto (u, \alpha)
    \end{align} as a linear map over a convex set.  As $E$ is convex,
    $p$ must be convex.  Similarly with $q$.
  \item For $p(0)$, this proceeds by definition.  For $p^{\star
      \star}(0)$, 
    \begin{align}
      \label{eq:74}
      p^{\star}(y) = \sup_{u} \{ \langle y, u \rangle - p(u) \} \\
      &= \sup_{u, x} \langle y, u \rangle - f(x, u) \\
      &= f^{\star}(0, y)
    \end{align} and
    \begin{align}
      \label{eq:75}
      p^{\star \star}(0) = \sup_{y} \langle 0, y \rangle -
      p^{\star}(y) \\
      &= \sup_{y} - f^{\star}(0, y) \\
      &= \sup_{y} \psi(y)
    \end{align}
  \item By definition, $0 \in \dom p \iff p(0) = \inf_{x} f(x) < \infty$.
  \end{enumerate}

  \todo{complete proof}
\end{proof}

\begin{thm}
  \label{defn:conjugate_functions:11}
  Let $f$ as in Definition 7.1.  Then weak duality holds
  \begin{equation}
    \label{eq:60}
    p(0) = \inf_{x} \phi(x) \geq \sup_{y} \psi(y) = p^{\star \star}(0)
  \end{equation}
  and under certain conditions the $\inf, \sup$ are equal and finite
  (strong duality).

  $p(0) \in \R$ and $p$ lower-semicontinuous at 0 if and only if $\inf
  \phi(x) = \sup \psi(y) \in \R$.
\end{thm}

\begin{defn}
  \label{defn:conjugate_functions:12}
  \begin{equation}
    \label{eq:61}
    \inf \phi - \sup \psi
  \end{equation} is the \textbf{duality gap}
\end{defn}

\begin{proof}
  ($\Leftarrow$) $p^{\star \star} \leq \cl p \leq p \Rightarrow \cl
  p(0) = p(0)$.
  
  ($\Rightarrow$) $\cl p$ is lowersemicontinuous, convex $\Rightarrow
  \cl p(x)$  is proper, $\sup \psi = (p^{\star})^{\star}(0) = (\cl p)^{\star
    \star}(0) = \cl p(0) = p(0) = \inf \phi$
\end{proof}

\begin{proposition}
\end{proposition}

\todo{Fill in notes from lecture}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "master"
%%% End: 
